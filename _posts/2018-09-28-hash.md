---
layout:     post
title:      "å­—ç¬¦ä¸²å“ˆå¸Œçš„åˆæ¢"
subtitle:   "å­—ç¬¦ä¸²å“ˆå¸Œä¹±æå¯ä»¥è§£å†³å¤§é‡çš„å­—ç¬¦ä¸²çš„é—®é¢˜â‘§"
date:       2018-09-28 23:00:00
author:     "programfiles"
header-img: "img/in-post/hash.jpg"
tags:
    - å­—ç¬¦ä¸²
---
```cpp
#include<iostream>

#include<cstdio>

#include<cstring>

using namespace std;

const int HASH = 10007;
const int MAXN = 2010;
struct HASHMAP
{
    int head[HASH],next[MAXN],sizes;
    unsigned long long state[MAXN];
    int f[MAXN];
    void init()
    {
        sizes = 0;
        memset(head,-1,sizeof(head));
    }
    int inserts(unsigned long long val,int _id)
    {
        int h = val%HASH;
        for(int i = head[h]; i != -1; i = next[i])
            if(val == state[i])
            {
                int tmp = f[i];
                f[i] = _id;
                return tmp;
            }
        f[sizes] = _id;
        state[sizes] = val;
        next[sizes] = head[h];
        head[h] = sizes++;
        return 0;
    }
} H;
const int SEED = 13331;
unsigned long long P[MAXN];
unsigned long long S[MAXN];
char str[MAXN];
int ans[MAXN][MAXN];
int main()
{
    P[0] = 1;
    for(int i = 1; i < MAXN; i++)
        P[i] = P[i-1] * SEED;
    int T;
    scanf("%d",&T);
    while(T--)
    {
        scanf("%s",str);
        int n = strlen(str);
        S[0] = 0;
        for(int i = 1; i <= n; i++)
            S[i] = S[i-1]*SEED + str[i-1];
        memset(ans,0,sizeof(ans));
        for(int L = 1; L <= n; L++)
        {
            H.init();
            for(int i = 1; i + L - 1 <= n; i++)
            {
                int l = H.inserts(S[i+L-1] - S[i-1]*P[L],i);
                ans[i][i+L-1]++;
                ans[l][i+L-1]--;
            }
        }
        for(int i = n; i >= 0; i--)
            for(int j = i; j <= n; j++)
                ans[i][j] += ans[i+1][j] + ans[i][j-1] - ans[i+1][j-1];//ç»Ÿè®¡å­ä¸²æ•°
        int m,u,v;
        scanf("%d",&m);
        while(m--)
        {
            scanf("%d%d",&u,&v);
            printf("%d\n",ans[u][v]);
        }
    }
    return 0;
}
```
>[hdu4622](http://acm.hdu.edu.cn/showproblem.php?pid=4622) ğŸ‘†<br>

å­—ç¬¦ä¸²å“ˆå¸Œï¼šå°†å­—ç¬¦ä¸²æœ‰æ•ˆçš„è½¬åŒ–ä¸ºä¸€ä¸ªæ•´æ•°ï¼Œæˆ‘ä»¬å†é¢˜ç›®ä¸­å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªhashå‡½æ•°ï¼Œä½¿å¾—æ¯ä¸€ä¸ªå­—ç¬¦ä¸²éƒ½å¯ä»¥æ˜ å°„åˆ°ä¸€ä¸ªæ•´æ•°ä¸Šã€‚<br>
## [hashè®²è§£](https://wenku.baidu.com/view/b7d3d1c6804d2b160a4ec090.html) ğŸ‘ˆè¿™æ˜¯ä¸ªä¼ é€é—¨
* * *
```cpp
struct HASHMAP
{
    int head[HASH],next[MAXN],sizes;
    unsigned long long state[MAXN];
    int f[MAXN];
    void init()
    {
        sizes = 0;
        memset(head,-1,sizeof(head));
    }
    int inserts(unsigned long long val,int _id)
    {
        int h = val%HASH;
        for(int i = head[h]; i != -1; i = next[i])
            if(val == state[i])
            {
                int tmp = f[i];
                f[i] = _id;
                return tmp;
            }
        f[sizes] = _id;
        state[sizes] = val;
        next[sizes] = head[h];
        head[h] = sizes++;
        return 0;
    }
} H;
```
è¿™ä¸ªæ˜¯binå·¨æ¨¡æ¿é‡Œçš„hashmapï¼Œåœ¨hashæŸ¥é‡å¾—æ—¶å€™å¦‚æœç›´æ¥è°ƒç”¨STLåº“ä¸­çš„mapæˆ–è€…setå»é‡æœ‰æ—¶å€™ä¼šè¶…æ—¶orz<br>
* * *
```cpp
for(int L = 1; L <= n; L++)
{
    H.init();
    for(int i = 1; i + L - 1 <= n; i++)
    {
        int l = H.inserts(S[i+L-1] - S[i-1]*P[L],i);
        ans[i][i+L-1]++;
        ans[l][i+L-1]--;
    }
}
```
inserts è¿”å›çš„æ˜¯è¿™ä¸ªé•¿åº¦çš„ä¸²ä¹‹å‰å‡ºç°çš„ä½ç½®ï¼Œä¹‹å‰å‡ºç°è¿‡ï¼Œæ‰€ä»¥åœ¨é‚£ä¸ªä½ç½®åˆ°å½“å‰è¿™ä¸ªä½ç½®è¿™æ®µåŒºé—´çš„ä¸ªæ•°è¦å‡-1ï¼ŒåŒä¸€ä¸ªåŒºé—´å†…åŒæ ·çš„ä¸²åªéœ€è¦è®¡ç®—ä¸€æ¬¡<br>

>è¯è¯´ä»¥å‰åšçš„å­—ç¬¦ä¸²çš„é¢˜æˆ‘è¿˜éƒ½æ²¡ç”¨hashä¹±æè¿‡ğŸ‘‡<br>

## é¢˜ç›®åˆ†æ
